<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>NOUS — A Game for Connoisseurs</title>
    <link rel="stylesheet" href="/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=EB+Garamond:wght@400;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- ARIA live region for screen announcements -->
    <div id="aria-status" class="visually-hidden" aria-live="polite"></div>

    <!-- App container controls visibility of screens -->
    <main id="app-container" data-game-state="WELCOME">
      <!-- ───────────────── WELCOME ───────────────── -->
      <section class="game-screen is-active" data-screen="WELCOME" aria-hidden="false">
        <h1 class="gold-text">NOUS</h1>
        <p class="subtitle">A Game for Connoisseurs</p>

        <ul id="welcome-options" aria-label="Main menu">
          <li>Play</li>
          <li>Rules</li>
          <li>Options</li>
          <li>Tutorial</li>     <!-- NEW -->
          <li>Reset Save</li>   <!-- NEW -->
        </ul>

        <p id="last-change" class="visually-hidden" aria-hidden="true"></p>
      </section>

      <!-- ───────────────── WAITING ROOM ───────────────── -->
      <section class="game-screen" data-screen="WAITING_ROOM" aria-hidden="true">
        <h2 class="gold-text">Waiting Room</h2>
        <p>How many are gathered tonight?</p>

        <div id="participant-panel" role="group" aria-label="Participants">
          <p>
            <strong>Participants:</strong>
            <span id="participant-count-display">1</span>
          </p>
          <p id="participant-flavor" hidden class="subtitle"></p>
        </div>
      </section>

      <!-- ───────────────── RULES ───────────────── -->
      <section class="game-screen" data-screen="RULES" aria-hidden="true">
        <h2 class="gold-text">What This Is</h2>
        <p>
          You share three buttons. You pull thread to reveal questions. You may
          tie it off to bank your gains… or keep pulling and risk it all.
        </p>
        <p>
          Answer choices are not always what they seem. Some are safe, some are
          revealing, some are wrong. Fate watches. Fate remembers.
        </p>
      </section>

      <!-- ───────────────── OPTIONS ───────────────── -->
      <section class="game-screen" data-screen="OPTIONS" aria-hidden="true">
        <h2 class="gold-text">Options</h2>

        <!-- Difficulty -->
        <div id="difficulty-block" style="margin: 1rem 0 2rem;">
          <h3>Difficulty</h3>
          <p class="subtitle">
            Sets the highest tier of questions that can appear this session.
          </p>

          <div
            id="difficulty-gauge"
            aria-label="Difficulty gauge"
            role="group"
            style="display:flex;align-items:center;gap:1rem;justify-content:center"
          >
            <!-- purely visual; UI/handler will update #difficulty-display -->
            <meter
              id="difficulty-meter"
              min="1"
              max="3"
              value="1"
              aria-hidden="true"
              style="width:260px;height:1rem"
            ></meter>
            <span id="difficulty-display" aria-live="polite">1</span>
          </div>

          <p style="opacity:.85;margin-top:.5rem">
            <em>1</em> → only Tier&nbsp;1 cards •
            <em>2</em> → Tiers&nbsp;1–2 •
            <em>3</em> → Tiers&nbsp;1–3
          </p>
        </div>

        <!-- Back affordance (controller maps the left button to "back") -->
        <p class="subtitle">Use the left button to go back.</p>
      </section>

      <!-- ───────────────── GAME LOBBY ───────────────── -->
      <section class="game-screen" data-screen="GAME_LOBBY" aria-hidden="true">
        <h2 class="gold-text">The Parlor</h2>

        <div id="hud">
          <p><strong>Lives:</strong> <span id="lives-display">0</span></p>
          <p><strong>Rounds to Win:</strong> <span id="rounds-display">3</span></p>
          <p><strong>Score:</strong> <span id="score-display">0</span></p>
          <p>
            <strong>Active Divinations:</strong>
            <span id="divinations-text">[None]</span>
          </p>
        </div>
      </section>

      <!-- ───────────────── ROUND LOBBY ───────────────── -->
      <section class="game-screen" data-screen="ROUND_LOBBY" aria-hidden="true">
        <h2 class="gold-text">Round Lobby</h2>

        <div id="round-hud" style="margin-bottom:1rem">
          <p><strong>Round:</strong> <span id="round-number-display">1</span></p>
          <p><strong>Thread:</strong> <span id="thread-display">0</span></p>
          <p><strong>Round Score:</strong> <span id="round-score">0</span></p>
          <p><strong>Category Hint:</strong> <span id="current-category"><span id="category-hint">[Faded Ink]</span></span></p>
          <p>
            <strong>Divinations this Round:</strong>
            <span id="divinations-text-round">[None]</span>
          </p>
        </div>

        <p class="subtitle">Weave to double the next question’s points.</p>
      </section>

      <!-- ───────────────── QUESTION ───────────────── -->
      <section class="game-screen" data-screen="QUESTION" aria-hidden="true">
        <h2 id="question-title" class="gold-text">Question</h2>
        <p id="question-text">…</p>

        <ul aria-label="Answers" style="margin-top:1rem;list-style:none">
          <li><strong>A</strong> — <span id="answer-a"></span></li>
          <li><strong>B</strong> — <span id="answer-b"></span></li>
          <li><strong>C</strong> — <span id="answer-c"></span></li>
        </ul>
      </section>

      <!-- ───────────────── REVEAL ───────────────── -->
      <section class="game-screen" data-screen="REVEAL" aria-hidden="true">
        <h2 id="result-header" class="gold-text">Result</h2>
        <p id="result-question" class="subtitle"></p>
        <p><strong>Your answer:</strong> <span id="result-chosen-answer"></span></p>
        <p id="result-explanation" style="margin-top:1rem"></p>
        <p id="result-outcome-message" style="margin-top:1rem"></p>
      </section>

      <!-- ───────────────── FATE ───────────────── -->
      <section class="game-screen" data-screen="FATE" aria-hidden="true">
        <h2 id="fate-card-title" class="gold-text">Fate</h2>
        <p id="fate-card-text" style="margin-bottom:1rem"></p>

        <!-- Inline display of choice labels (controller shows buttons anyway) -->
        <ul aria-label="Fate choices" style="list-style:none;opacity:.85">
          <li>A — <span id="fate-a-text">NOUS</span></li>
          <li>B — <span id="fate-b-text">NOUS</span></li>
          <li>C — <span id="fate-c-text">NOUS</span></li>
        </ul>
      </section>

      <!-- ───────────────── FATE RESULT ───────────────── -->
      <section class="game-screen" data-screen="FATE_RESULT" aria-hidden="true">
        <h2 class="gold-text">The Tally</h2>
        <p id="divination-outcome"></p>
      </section>

      <!-- ───────────────── THREAD SEVERED ───────────────── -->
      <section class="game-screen" data-screen="THREAD_SEVERED" aria-hidden="true">
        <h2 class="gold-text">Thread Severed</h2>
        <p class="subtitle">You lose the round’s bank.</p>
        <p>Lost: <span id="lost-points-display">0</span></p>
      </section>

      <!-- ───────────────── FINAL READING ───────────────── -->
      <section class="game-screen" data-screen="FINAL_READING" aria-hidden="true">
        <h2 class="gold-text">Final Reading</h2>
        <p class="subtitle">It knows you now.</p>
        <div id="reading-body">
          <!-- your dynamic epilogue content -->
        </div>
      </section>

      <!-- ───────────────── CREDITS ───────────────── -->
      <section class="game-screen" data-screen="CREDITS" aria-hidden="true">
        <h2 class="gold-text">Credits</h2>
        <p>Created by <strong>Jake Spencer</strong> — © Sparr Games.</p>
      </section>
    </main>

    <!-- Three-button controller -->
    <nav id="controller" data-controller-state="WELCOME" aria-label="Controller">
      <button id="btn0" class="ctrl"><span class="button-label">A</span></button>
      <button id="btn1" class="ctrl"><span class="button-label">B</span></button>
      <button id="btn2" class="ctrl"><span class="button-label">C</span></button>
    </nav>

    <!-- App entry -->
    <script type="module" src="/src/script.js"></script>
  </body>
</html>
